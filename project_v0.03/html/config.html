<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –†—É–ª–µ—Ç–∫–∏</title>
  <link rel="stylesheet" href="../css/panel.css">
  <link rel="stylesheet" href="../css/config.css">
  <style>
    body {
      display: flex;
      justify-content: space-between;
      padding: 20px;
    }
    .settings-container {
      width: 60%;
    }
    .roulette-preview-container {
      width: 35%;
      border: 1px solid #ccc;
      padding: 20px;
      border-radius: 10px;
      background-color: #2e2e2e; /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω */
      color: #fff; /* –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ */
    }
    .preview-image-container {
      position: relative;
      display: inline-block;
      width: 80px;
      height: 80px;
      margin: 5px;
    }
    .preview-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 8px;
    }
    .delete-image-button {
      position: absolute;
      top: 2px;
      right: 2px;
      background: red;
      color: white;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .slot-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
      height: 400px;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border: 1px solid #ccc;
      border-radius: 8px;
      overflow: hidden;
    }
    .modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    .modal .border {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 2px solid #000;
      box-sizing: border-box;
    }
    .modal .corner {
      position: absolute;
      width: 20px;
      height: 20px;
      background: white;
      border: 1px solid black;
      border-radius: 50%;
    }
    .modal .corner.tl { top: -10px; left: -10px; }
    .modal .corner.tr { top: -10px; right: -10px; }
    .modal .corner.bl { bottom: -10px; left: -10px; }
    .modal .corner.br { bottom: -10px; right: -10px; }
  </style>
</head>
<body>
  <div class="settings-container">
    <h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –†—É–ª–µ—Ç–∫–∏ üé∞</h1>

    <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞—Ä–∞–±–∞–Ω–∞ -->
    <div>
      <label for="roulette-name">–ù–∞–∑–≤–∞–Ω–∏–µ –±–∞—Ä–∞–±–∞–Ω–∞:</label>
      <input type="text" id="roulette-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" value="–ë–∞—Ä–∞–±–∞–Ω –∫–∞–∑–∏–Ω–æ">
    </div>

    <!-- –°–ª–æ–≤–∞ –¥–ª—è –±–∞—Ä–∞–±–∞–Ω–∞ -->
    <div>
      <label for="roulette-words">–°–ª–æ–≤–∞ –¥–ª—è –±–∞—Ä–∞–±–∞–Ω–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
      <textarea id="roulette-words" placeholder="–°–ª–æ–≤–æ1, –°–ª–æ–≤–æ2, –°–ª–æ–≤–æ3">–í–æ–∏–Ω, –ú–∞–≥, –ê—Å—Å–∞—Å–∏–Ω</textarea>
    </div>

    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –±–∞—Ä–∞–±–∞–Ω–∞ -->
    <div>
      <label for="roulette-images">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –±–∞—Ä–∞–±–∞–Ω–∞:</label>
      <input type="file" id="roulette-images" multiple accept="image/*">
      <div id="image-preview-container">
        <h3>–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</h3>
        <div id="preview-list" style="display: flex; flex-wrap: wrap; gap: 10px;"></div>
      </div>
    </div>

    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–≤–æ–¥–∫–∏ –±–∞—Ä–∞–±–∞–Ω–∞ -->
    <div>
      <label for="roulette-border-color">–¶–≤–µ—Ç –æ–±–≤–æ–¥–∫–∏:</label>
      <input type="color" id="roulette-border-color" value="#9146FF">
      <label for="roulette-border-width">–¢–æ–ª—â–∏–Ω–∞ –æ–±–≤–æ–¥–∫–∏ (px):</label>
      <input type="number" id="roulette-border-width" min="1" max="10" value="5">
    </div>

    <button id="save-settings">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
  </div>

  <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ä—É–ª–µ—Ç–∫–∏ -->
  <div class="roulette-preview-container">
    <h2>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ä—É–ª–µ—Ç–∫–∏</h2>
    <div class="slot-machine-container" id="slot-machine-preview">
      <div class="indicator"></div>
      <div class="slot-items" id="slot-items-preview">
        <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã —Ä—É–ª–µ—Ç–∫–∏ -->
      </div>
    </div>
    <div class="result" id="result-preview">üéâ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</div>
  </div>

  <!-- Modal for Image Transformation -->
  <div id="image-modal" class="modal">
    <div class="border"></div>
    <div class="corner tl"></div>
    <div class="corner tr"></div>
    <div class="corner bl"></div>
    <div class="corner br"></div>
    <img id="modal-image" src="" alt="Transformed Image">
  </div>

  <script>
    const imageInput = document.getElementById('roulette-images');
    const previewList = document.getElementById('preview-list');
    const uploadedImages = new Set();
    const modal = document.getElementById('image-modal');
    const modalImage = document.getElementById('modal-image');
    const rouletteWordsInput = document.getElementById('roulette-words');
    const slotItemsPreview = document.getElementById('slot-items-preview');
    const rouletteItems = [];

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä—É–ª–µ—Ç–∫–∏
    function updateRoulettePreview() {
      slotItemsPreview.innerHTML = '';
      const words = rouletteWordsInput.value.split(',').map(word => word.trim()).filter(word => word);
      const items = [...rouletteItems, ...words.map(word => ({ type: 'word', data: word }))];

      items.forEach(item => {
        const slotItem = document.createElement('div');
        slotItem.className = 'slot-item';

        if (item.type === 'image') {
          const img = document.createElement('img');
          img.src = item.data;
          slotItem.appendChild(img);
        } else if (item.type === 'word') {
          slotItem.textContent = item.data;
        }

        slotItemsPreview.appendChild(slotItem);
      });
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    function openModal(imageSrc) {
      modalImage.src = imageSrc;
      modal.style.display = 'block';
    }

    modal.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    imageInput.addEventListener('change', (event) => {
      Array.from(event.target.files).forEach((file) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          if (uploadedImages.has(e.target.result)) {
            alert('–≠—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!');
            return;
          }
          uploadedImages.add(e.target.result);
          rouletteItems.push({ type: 'image', data: e.target.result });

          const imgContainer = document.createElement('div');
          imgContainer.className = 'preview-image-container';

          const img = document.createElement('img');
          img.src = e.target.result;
          img.alt = 'Image';
          img.className = 'preview-image';
          img.addEventListener('dblclick', () => openModal(e.target.result));
          imgContainer.appendChild(img);

          const deleteButton = document.createElement('button');
          deleteButton.className = 'delete-image-button';
          deleteButton.textContent = '√ó';
          deleteButton.addEventListener('click', () => {
            uploadedImages.delete(e.target.result);
            rouletteItems.splice(rouletteItems.findIndex(item => item.data === e.target.result), 1);
            previewList.removeChild(imgContainer);
            updateRoulettePreview();
          });

          imgContainer.appendChild(deleteButton);
          previewList.appendChild(imgContainer);
          updateRoulettePreview();
        };
        reader.readAsDataURL(file);
      });
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    updateRoulettePreview();
  </script>
</body>
</html>